= Exercise 10
== Exercise 10: Deleting Nodes and Relationships

=== Preparations

Make sure you have the Movie database, which contains 173 nodes and 258 relationships.

This is what you should see when you click the database icon:

image::{guides}/img/AfterExercise9.png[After exercise 9,200,200, role=left]

If your database does not have this number of nodes and relationships, you can use the script below to reset it:

[source, cypher]
----
include::scripts/AfterExercise9.cypher[]
----


== Exercise Overview

In the previous exercise, you created relationships between _Person_ and _Movie_ nodes and you modified the properties for these relationships.

In this exercise you will delete nodes and relationships from the graph.

. In Part 1, you delete a relationship.
. In Part 2, you delete a node and its relationships.

Go to the next page to perform the two parts of this exercise.

== Instructions, Exercise 10, Part 1
.*Deleting a relationship*

Recall that in the graph we have been working with, we have the _HELPED_ relationship between _Tom Hanks_ and _Gary Sinise_.
We have decided that we no longer need this relationship in the graph.

Write Cypher statements to:

. Delete the _HELPED_ relationship from the graph.
. Query the graph to confirm that the relationship no longer exists.

== Solution, Exercise 10, Part 1
.*Deleting a relationship*

Write Cypher statements to:

*1. Delete the _HELPED_ relationship from the graph.*

[source, cypher]
----
MATCH (:Person)-[rel:HELPED]-(:Person)
DELETE rel
----

[.thumb]
image::{guides}/img/DeleteHELPED.png[DeleteHELPED,width=400,float="right"]

The result returned should be:

++++
<div style="clear: both;"></div>
++++

*2. Query the graph to confirm that the relationship no longer exists.* 

[source, cypher]
----
MATCH (:Person)-[rel:HELPED]-(:Person)
RETURN rel
----

[.thumb]
image::{guides}/img/ConfirmDeleteHELPED.png[ConfirmDeleteHELPED,width=400,float="right"]

The result returned should be:

++++
<div style="clear: both;"></div>
++++

Next, Part 2

== Instructions, Exercise 10, Part 2
.*Deleting nodes and relationships*

We want to remove the movie, _Forrest Gump_ from the graph.

Create Cypher statements to do the following:

. Query the graph to display _Forrest Gump_ and all of its relationships.
. Try deleting the _Forrest Gump_ node without detaching its relationships.
Do you receive an error?
. Delete _Forrest Gump_, along with its relationships in the graph.
. Query the graph to confirm that the _Forrest Gump_ node has been deleted.

== Solution, Exercise 10, Part 2
.*Deleting nodes and relationships*

We want to remove the movie, _Forrest Gump_ from the graph.

Create Cypher statements to do the following:

*1. Query the graph to display _Forrest Gump_ and all of its relationships.*

[source, cypher]
----
MATCH (p:Person)-[rel]-(m:Movie)
WHERE m.title = 'Forrest Gump'
RETURN p, rel, m
----

[.thumb]
image::{guides}/img/QueryForrestGump.png[QueryForrestGump,width=400,float="right"]

The result returned should be:

++++
<div style="clear: both;"></div>
++++

*2. Try deleting the _Forrest Gump_ node without detaching its relationships.
Do you receive an error?*

[source, cypher]
----
MATCH (m:Movie)
WHERE m.title = 'Forrest Gump'
DELETE m
----

[.thumb]
image::{guides}/img/DeleteNodeFailed.png[DeleteNodeFailed,width=400,float="right"]

The result returned should be:

++++
<div style="clear: both;"></div>
++++

*3. Delete _Forrest Gump_, along with its relationships in the graph.*

[source, cypher]
----
MATCH (m:Movie)
WHERE m.title = 'Forrest Gump'
DETACH DELETE m
----

[.thumb]
image::{guides}/img/DetachDelete.png[DetachDelete,width=400,float="right"]

The result returned should be:

++++
<div style="clear: both;"></div>
++++

*4. Query the graph to confirm that the _Forrest Gump_ node has been deleted.*

[source, cypher]
----
MATCH (p:Person)-[rel]-(m:Movie)
WHERE m.title = 'Forrest Gump'
RETURN p, rel, m
----

[.thumb]
image::{guides}/img/NoForrestGump.png[NoForrestGump,width=400,float="right"]

The result returned should be:

++++
<div style="clear: both;"></div>
++++

== Exercise Summary

In this exercise you deleted relationships and a node from the graph.

pass:a[<a play-topic='{guides}/11.html'>Continue to Exercise 11</a>]
