<style type="text/css" media="screen">
/*
.nodes-image {
	margin:-100;
}
*/	
@import url("//maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css");

.imageblock .content img, .image img {max-width: 900px;max-height: 300px;}
.deck h3, .deck h4 {display: block !important;margin-bottom:8px;margin-top:5px;}
.listingblock {margin:8px;}
.pull-bottom {position:relative;bottom:1em;}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note:before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip:before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning:before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution:before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important:before{content:"\f06a";color:#bf0000}
.admonitionblock.note.speaker { display:none; }
</style>
<style type="text/css" media="screen">
/* #editor.maximize-editor .CodeMirror-code { font-size:24px; line-height:26px; } */
</style>
<article class="guide" ng-controller="AdLibDataController">
  <carousel class="deck container-fluid">
    <!--slide class="row-fluid">
      <div class="col-sm-3">
        <h3>Fraud Detection Using Neo4j Platform and PaySim Dataset</h3>
        <p class="lead">Information</p>
			<!dl>
				
				
				
				
				
			</dl>
		</div>
      <div class="col-sm-9">
        <figure>
          <img style="width:300px" src=""/>
        </figure>
      </div>
    </slide-->
    


   <h4>Fraud Detection Using Neo4j Platform and PaySim Dataset</h4>
   


<slide class="row-fluid">
  <div class="col-sm-12">
    <h3>Using the Graph Data Science (GDS) Library &amp; PaySim Dataset For Fraud Detection.</h3>
    <br/>
    <div>
      <div class="paragraph">
<p>This browser guide is walking you through a step by step hands-on exercise, using the GDS Library to detect first and second party fraud with the PaySim dataset.</p>
</div>
<div class="paragraph">
<p>The modules included in this guide are the following:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Framing the problem</p>
</li>
<li>
<p>Data Understanding</p>
</li>
<li>
<p>First-party Fraud Detection</p>
</li>
<li>
<p>Second-party Fraud Detection</p>
</li>
</ol>
</div>
	</div>
  </div>
</slide>



<slide class="row-fluid">
  <div class="col-sm-12">
    <h3>Module 1: Framing the Problem</h3>
    <br/>
    <div>
      


   <h4><strong>What is Fraud?</strong></h4>
   <div class="paragraph">
<p><strong>Fraud occurs</strong> when an individual or group of individuals, or a business entity <strong>intentionally</strong>
deceives another individual or business entity with <strong>misrepresentation</strong> of identity, products,
services, or financial transactions and/or <strong>false promises</strong> with no intention of fulfilling them.</p>
</div>
<div class="paragraph">
<p>&#160;<br></p>
</div>



   <h4><strong>Fraud Categories</strong></h4>
   <div class="ulist">
<ul>
<li>
<p><strong>First-party Fraud</strong></p>
<div class="ulist">
<ul>
<li>
<p>An individual, or group of individuals, misrepresent their identity or give false information when applying for a product or services to receive more favourable rates or when have no intention of repayment.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Second-party Fraud</strong></p>
<div class="ulist">
<ul>
<li>
<p>An individual knowingly gives their identity or personal information to another individual to commit fraud or someone is perpetrating fraud in his behalf.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Third-party Fraud</strong></p>
<div class="ulist">
<ul>
<li>
<p>An individual, or group of individuals, create or use another person&#8217;s identity, or personal details, to open or takeover an account.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
	</div>
  </div>
</slide>



<slide class="row-fluid">
  <div class="col-sm-12">
    <h3>End of Module 1</h3>
    <br/>
    <div>
      <div class="paragraph">
<p>In this module we framed the problem by defining Fraud and understanding the different fraud categories.</p>
</div>
<div class="imageblock" style="text-align: center;">
<div class="content">
<img src="https://guides.neo4j.com/gds-paysim-demo/img/first-party-third-party-fraud.png" alt="Fraud" width="600">
</div>
</div>
	</div>
  </div>
</slide>



<slide class="row-fluid">
  <div class="col-sm-12">
    <h3>Module 2: Data Understanding</h3>
    <br/>
    <div>
      <div class="paragraph">
<p>This module includes the following exercises:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Database Schema</p>
</li>
<li>
<p>Graph Size</p>
</li>
<li>
<p>Node Label Frequency</p>
</li>
<li>
<p>Relationship Type Frequency</p>
</li>
<li>
<p>Transaction Type Frequency</p>
</li>
</ol>
</div>
	</div>
  </div>
</slide>



<slide class="row-fluid">
  <div class="col-sm-12">
    <h3>Exercise 1: Database Schema</h3>
    <br/>
    <div>
      <div class="listingblock">
<div class="content">
<pre mode="cypher"  class="highlight pre-scrollable programlisting cm-s-neo code runnable standalone-example ng-binding" data-lang="cypher" lang="cypher"><!--code class="cypher language-cypher"-->CALL db.schema.visualization();<!--/code--></pre>
</div>
</div>
<div class="imageblock" style="text-align: center;">
<div class="content">
<img src="https://guides.neo4j.com/gds-paysim-demo/img/schema.png" alt="Schema" width="600">
</div>
</div>
	</div>
  </div>
</slide>



<slide class="row-fluid">
  <div class="col-sm-12">
    <h3>Exercise 2: Graph Size</h3>
    <br/>
    <div>
      <div class="listingblock">
<div class="content">
<pre mode="cypher"  class="highlight pre-scrollable programlisting cm-s-neo code runnable standalone-example ng-binding" data-lang="cypher" lang="cypher"><!--code class="cypher language-cypher"-->CALL apoc.meta.stats();<!--/code--></pre>
</div>
</div>
	</div>
  </div>
</slide>



<slide class="row-fluid">
  <div class="col-sm-12">
    <h3>Exercise 3: Node Label Frequency</h3>
    <br/>
    <div>
      <div class="listingblock">
<div class="content">
<pre mode="cypher"  class="highlight pre-scrollable programlisting cm-s-neo code runnable standalone-example ng-binding" data-lang="cypher" lang="cypher"><!--code class="cypher language-cypher"-->CALL db.labels() YIELD label
CALL apoc.cypher.run('MATCH (:`'+label+'`) RETURN count(*) as freq',{})
YIELD value
WITH label,value.freq AS freq
CALL apoc.meta.stats() YIELD nodeCount
WITH *,3 AS presicion
WITH *,10^presicion AS factor,toFloat(freq)/toFloat(nodeCount) AS relFreq
RETURN label AS nodeLabel, freq AS frequency,round(relFreq*factor)/factor AS relativeFrequency ORDER BY freq DESC;<!--/code--></pre>
</div>
</div>
	</div>
  </div>
</slide>



<slide class="row-fluid">
  <div class="col-sm-12">
    <h3>Exercise 4: Relationship Type Frequency</h3>
    <br/>
    <div>
      <div class="listingblock">
<div class="content">
<pre mode="cypher"  class="highlight pre-scrollable programlisting cm-s-neo code runnable standalone-example ng-binding" data-lang="cypher" lang="cypher"><!--code class="cypher language-cypher"-->CALL db.relationshipTypes() YIELD relationshipType as type
CALL apoc.cypher.run('MATCH ()-[:`'+type+'`]-&gt;() RETURN count(*) as freq',{})
YIELD value
WITH type AS relationshipType, value.freq AS freq
CALL apoc.meta.stats() YIELD relCount
WITH *,3 AS presicion
WITH *, 10^presicion AS factor,toFloat(freq)/toFloat(relCount) as relFreq
RETURN relationshipType, freq AS frequency,
    round(relFreq*factor)/factor AS relativeFrequency
ORDER BY freq DESC;<!--/code--></pre>
</div>
</div>
	</div>
  </div>
</slide>



<slide class="row-fluid">
  <div class="col-sm-12">
    <h3>Exercise 5: Nodes &amp; Relationship Properties</h3>
    <br/>
    <div>
      <div class="listingblock">
<div class="content">
<pre mode="cypher"  class="highlight pre-scrollable programlisting cm-s-neo code runnable standalone-example ng-binding" data-lang="cypher" lang="cypher"><!--code class="cypher language-cypher"-->CALL apoc.meta.data() YIELD label,property,type,elementType
WHERE type&lt;&gt;'RELATIONSHIP'
RETURN elementType,label,property,type
ORDER BY elementType,label,property;<!--/code--></pre>
</div>
</div>
	</div>
  </div>
</slide>



<slide class="row-fluid">
  <div class="col-sm-12">
    <h3>Exercise 6: Transaction Type Frequency</h3>
    <br/>
    <div>
      <div class="listingblock">
<div class="content">
<pre mode="cypher"  class="highlight pre-scrollable programlisting cm-s-neo code runnable standalone-example ng-binding" data-lang="cypher" lang="cypher"><!--code class="cypher language-cypher"-->MATCH (t:Transaction)
WITH sum(t.amount) AS globalSum, count(t) AS globalCnt
WITH *, 10^3 AS scaleFactor
UNWIND ['CashIn', 'CashOut', 'Payment', 'Debit', 'Transfer'] AS txType
  CALL apoc.cypher.run('MATCH (t:' + txType + ')
    RETURN sum(t.amount) as txAmount, count(t) AS txCnt', {})
  YIELD value
RETURN txType,value.txAmount AS TotalMarketValue,
  100*round(scaleFactor*(toFloat(value.txAmount)/toFloat(globalSum)))
    /scaleFactor AS `%MarketValue`,
  100*round(scaleFactor*(toFloat(value.txCnt)/toFloat(globalCnt)))
    /scaleFactor AS `%MarketTransactions`,
  toInteger(toFloat(value.txAmount)/toFloat(value.txCnt)) AS AvgTransactionValue,
  value.txCnt AS NumberOfTransactions
ORDER BY `%MarketTransactions` DESC;<!--/code--></pre>
</div>
</div>
	</div>
  </div>
</slide>



<slide class="row-fluid">
  <div class="col-sm-12">
    <h3>End of Module 2</h3>
    <br/>
    <div>
      <div class="paragraph">
<p>In this module we explored the PaySim dataset by getting familiar with:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Database schema and size</p>
</li>
<li>
<p>Node labels and relationship types distributions</p>
</li>
<li>
<p>Node and relationship properties</p>
</li>
<li>
<p>Transaction type distribution</p>
</li>
</ol>
</div>
	</div>
  </div>
</slide>



<slide class="row-fluid">
  <div class="col-sm-12">
    <h3>Module 3: First-party Fraud</h3>
    <br/>
    <div>
      <div class="paragraph">
<p>This module contains the following exercises:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Preliminary Analysis</p>
</li>
<li>
<p>Weakly Connected Components for identifying clusters of clients sharing personally identifiable information (PII)</p>
</li>
<li>
<p>Node Similarity for pairwise similarity calculation on the clients sharing PII</p>
</li>
<li>
<p>Degree Centrality for computing a first party fraud score</p>
</li>
<li>
<p>Using the first-party fraud score for identifying first-party fraudsters</p>
</li>
<li>
<p>Remove all Named Graph loaded during this module</p>
</li>
</ol>
</div>
	</div>
  </div>
</slide>



<slide class="row-fluid">
  <div class="col-sm-12">
    <h3>Exercise 1: Preliminary Analysis</h3>
    <br/>
    <div>
      <div class="paragraph">
<p>This exercise is compose by the following task:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Identifying clients sharing PII</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Explore all pairs of clients sharing PII</p>
</li>
<li>
<p>Calculate the number of unique clients sharing PII</p>
</li>
</ol>
</div>
</li>
<li>
<p>Create a Cypher parameter with a single pair of client sharing PII</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Visualized their PII</p>
</li>
<li>
<p>Compute the Jaccard Similarity score between them</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
	</div>
  </div>
</slide>



<slide class="row-fluid">
  <div class="col-sm-12">
    <h3>Exercise 1, Task 1: Identifying clients sharing PII</h3>
    <br/>
    <div>
      <div class="paragraph">
<p>Identifying pairs of clients sharing PII</p>
</div>
<div class="listingblock">
<div class="content">
<pre mode="cypher"  class="highlight pre-scrollable programlisting cm-s-neo code runnable standalone-example ng-binding" data-lang="cypher" lang="cypher"><!--code class="cypher language-cypher"-->MATCH (c1:Client)-[:HAS_EMAIL|:HAS_PHONE|:HAS_SSN]-&gt;(info)
&lt;-[:HAS_EMAIL|:HAS_PHONE|:HAS_SSN]-(c2:Client)
WHERE c1.id&lt;&gt;c2.id
RETURN c1.id,c2.id,count(*) AS freq ORDER BY freq DESC;<!--/code--></pre>
</div>
</div>
<div class="paragraph">
<p>Number of unique clients sharing PII</p>
</div>
<div class="listingblock">
<div class="content">
<pre mode="cypher"  class="highlight pre-scrollable programlisting cm-s-neo code runnable standalone-example ng-binding" data-lang="cypher" lang="cypher"><!--code class="cypher language-cypher"-->MATCH (c1:Client)-[:HAS_EMAIL|:HAS_PHONE|:HAS_SSN]-&gt;(info)
&lt;-[:HAS_EMAIL|:HAS_PHONE|:HAS_SSN]-(c2:Client)
WHERE c1.id&lt;&gt;c2.id
RETURN count(DISTINCT c1.id) AS freq;<!--/code--></pre>
</div>
</div>
	</div>
  </div>
</slide>



<slide class="row-fluid">
  <div class="col-sm-12">
    <h3>Exercise 1, Task 2: Create a Cypher parameter with a single pair of client sharing PII</h3>
    <br/>
    <div>
      <div class="paragraph">
<p>Create a Cypher parameter with a single pair of client sharing PII</p>
</div>
<div class="listingblock">
<div class="content">
<pre mode="cypher"  class="highlight pre-scrollable programlisting cm-s-neo code runnable standalone-example ng-binding" data-lang="cypher" lang="cypher"><!--code class="cypher language-cypher"-->:param clients=&gt;apoc.cypher.runFirstColumnSingle('MATCH (c1:Client)-[:HAS_EMAIL|:HAS_PHONE|:HAS_SSN]-&gt;(info)&lt;-[:HAS_EMAIL|:HAS_PHONE|:HAS_SSN]-(c2:Client) WHERE id(c1)&lt;&gt;id(c2) WITH c1,c2,count(*) AS freq RETURN {client1 :c1.id,client2:c2.id} ORDER BY freq LIMIT 1',{});<!--/code--></pre>
</div>
</div>
<div class="paragraph">
<p>Visualizing their PII</p>
</div>
<div class="listingblock">
<div class="content">
<pre mode="cypher"  class="highlight pre-scrollable programlisting cm-s-neo code runnable standalone-example ng-binding" data-lang="cypher" lang="cypher"><!--code class="cypher language-cypher"-->MATCH path=(c:Client)
-[:HAS_EMAIL|:HAS_PHONE|:HAS_SSN]-&gt;(ids)
WHERE c.id IN [$clients['client1'],$clients['client2']]
RETURN path;<!--/code--></pre>
</div>
</div>
<div class="paragraph">
<p>Calculating the Jaccard Similarity Score</p>
</div>
<div class="listingblock">
<div class="content">
<pre mode="cypher"  class="highlight pre-scrollable programlisting cm-s-neo code runnable standalone-example ng-binding" data-lang="cypher" lang="cypher"><!--code class="cypher language-cypher"-->MATCH (c1:Client)
-[:HAS_EMAIL|:HAS_PHONE|:HAS_SSN]-&gt;(ids)
WHERE c1.id=$clients['client1']
WITH c1,collect(id(ids)) AS ids1
MATCH (c2:Client)
-[:HAS_EMAIL|:HAS_PHONE|:HAS_SSN]-&gt;(ids)
WHERE c2.id=$clients['client2']
WITH c1,ids1,c2,collect(id(ids)) AS ids2
RETURN c1.id,c2.id,
	gds.alpha.similarity.jaccard(ids1,ids2) AS similarityScore;<!--/code--></pre>
</div>
</div>
	</div>
  </div>
</slide>



<slide class="row-fluid">
  <div class="col-sm-12">
    <h3>End of Module 2</h3>
    <br/>
    <div>
      <div class="paragraph">
<p>In this module we accomplished the following tasks:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Explored all pairs of clients sharing PII and calculated the number of unique clients involved in these pairs</p>
</li>
<li>
<p>Selected a pair of clients sharing PII to visualize their identifiers and calculate their similarity</p>
</li>
</ol>
</div>
<div class="imageblock" style="text-align: center;">
<div class="content">
<img src="https://guides.neo4j.com/gds-paysim-demo/img/sharingPIIExample.png" alt="SharingPII" width="600">
</div>
</div>
	</div>
  </div>
</slide>



<slide class="row-fluid">
  <div class="col-sm-12">
    <h3>Module 3: First Party Fraud</h3>
    <br/>
    <div>
      <div class="paragraph">
<p>This module contains the following exercises:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Weakly Connected Components (WCC) to Identify Clusters of Clients Sharing PII</p>
</li>
<li>
<p>Node Similarity for Pairwise Similarity Calculation</p>
</li>
<li>
<p>Degree Centrality for Computing a First-party Fraud Score</p>
</li>
<li>
<p>Removing Named Graph loaded during this module</p>
</li>
</ol>
</div>
	</div>
  </div>
</slide>



<slide class="row-fluid">
  <div class="col-sm-12">
    <h3>Exercise 1: Weakly Connected Components (WCC) to Identify Clusters of Clients Sharing PII</h3>
    <br/>
    <div>
      <div class="paragraph">
<p>This exercise is compose of the following task:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Estimate the amount of memory required to load an in-memory graph using a Cypher projection</p>
</li>
<li>
<p>Load the in-memory graph</p>
</li>
<li>
<p>List graphs currently available in the Graph Catalog</p>
</li>
<li>
<p>Estimate the amount of memory required to execute WCC in the named graph</p>
</li>
<li>
<p>Obtain descriptive statistics of the results of WCC prior to execute the procedure</p>
</li>
<li>
<p>Explore the results of the WCC procedure</p>
</li>
<li>
<p>Store the results of the WCC procedure</p>
</li>
<li>
<p>Create a Cypher parameter containing the biggest clusters identified by WCC</p>
</li>
<li>
<p>Visualize these big clusters</p>
</li>
</ol>
</div>
	</div>
  </div>
</slide>



<slide class="row-fluid">
  <div class="col-sm-12">
    <h3>Exercise 1, Task 1: WCC Memory Estimation</h3>
    <br/>
    <div>
      <div class="listingblock">
<div class="content">
<pre mode="cypher"  class="highlight pre-scrollable programlisting cm-s-neo code runnable standalone-example ng-binding" data-lang="cypher" lang="cypher"><!--code class="cypher language-cypher"-->CALL gds.graph.create.cypher.estimate(
'MATCH (c:Client) RETURN id(c) AS id',
'MATCH (c1:Client)
-[:HAS_EMAIL|:HAS_PHONE|:HAS_SSN]-&gt;(info)
&lt;-[:HAS_EMAIL|:HAS_PHONE|:HAS_SSN]
-(c2:Client)
WHERE c1.id&lt;&gt;c2.id
RETURN id(c1) AS source,id(c2) AS target,count(*) AS weight')
YIELD requiredMemory,nodeCount,relationshipCount;<!--/code--></pre>
</div>
</div>
	</div>
  </div>
</slide>



<slide class="row-fluid">
  <div class="col-sm-12">
    <h3>Exercise 1, Task 2: Loading WCC graph to the Graph Catalog</h3>
    <br/>
    <div>
      <div class="listingblock">
<div class="content">
<pre mode="cypher"  class="highlight pre-scrollable programlisting cm-s-neo code runnable standalone-example ng-binding" data-lang="cypher" lang="cypher"><!--code class="cypher language-cypher"-->CALL gds.graph.create.cypher('WCC',
'MATCH (c:Client) RETURN id(c) AS id',
'MATCH (c1:Client)
-[:HAS_EMAIL|:HAS_PHONE|:HAS_SSN]-&gt;(info)
&lt;-[:HAS_EMAIL|:HAS_PHONE|:HAS_SSN]
-(c2:Client)
WHERE c1.id&lt;&gt;c2.id
RETURN id(c1) AS source,id(c2) AS target,count(*) AS weight')
YIELD graphName,nodeCount,relationshipCount,createMillis;<!--/code--></pre>
</div>
</div>
	</div>
  </div>
</slide>



<slide class="row-fluid">
  <div class="col-sm-12">
    <h3>Exercise 1, Task 3: Listing graphs in the Graph Catalog</h3>
    <br/>
    <div>
      <div class="listingblock">
<div class="content">
<pre mode="cypher"  class="highlight pre-scrollable programlisting cm-s-neo code runnable standalone-example ng-binding" data-lang="cypher" lang="cypher"><!--code class="cypher language-cypher"-->CALL gds.graph.list();<!--/code--></pre>
</div>
</div>
	</div>
  </div>
</slide>



<slide class="row-fluid">
  <div class="col-sm-12">
    <h3>Exercise 1, Task 4: WCC Memory Estimating</h3>
    <br/>
    <div>
      <div class="listingblock">
<div class="content">
<pre mode="cypher"  class="highlight pre-scrollable programlisting cm-s-neo code runnable standalone-example ng-binding" data-lang="cypher" lang="cypher"><!--code class="cypher language-cypher"-->CALL gds.wcc.stream.estimate('WCC');<!--/code--></pre>
</div>
</div>
	</div>
  </div>
</slide>



<slide class="row-fluid">
  <div class="col-sm-12">
    <h3>Exercise 1, Task 5: WCC Descriptive Statistics</h3>
    <br/>
    <div>
      <div class="listingblock">
<div class="content">
<pre mode="cypher"  class="highlight pre-scrollable programlisting cm-s-neo code runnable standalone-example ng-binding" data-lang="cypher" lang="cypher"><!--code class="cypher language-cypher"-->CALL gds.wcc.stats('WCC');<!--/code--></pre>
</div>
</div>
	</div>
  </div>
</slide>



<slide class="row-fluid">
  <div class="col-sm-12">
    <h3>Exercise 1, Task 6: Using WCC to identify clusters of clients sharing PII</h3>
    <br/>
    <div>
      <div class="listingblock">
<div class="content">
<pre mode="cypher"  class="highlight pre-scrollable programlisting cm-s-neo code runnable standalone-example ng-binding" data-lang="cypher" lang="cypher"><!--code class="cypher language-cypher"-->CALL gds.wcc.stream('WCC')
YIELD componentId,nodeId
WITH componentId AS cluster,gds.util.asNode(nodeId) AS client
WITH cluster,collect(client.id) AS clients
WITH *,size(clients) AS clusterSize
WHERE clusterSize&gt;1
RETURN cluster,clusterSize,clients
ORDER by clusterSize DESC;<!--/code--></pre>
</div>
</div>
	</div>
  </div>
</slide>



<slide class="row-fluid">
  <div class="col-sm-12">
    <h3>Exercise 1, Task 7: Writing the clusters the database.</h3>
    <br/>
    <div>
      <div class="listingblock">
<div class="content">
<pre mode="cypher"  class="highlight pre-scrollable programlisting cm-s-neo code runnable standalone-example ng-binding" data-lang="cypher" lang="cypher"><!--code class="cypher language-cypher"-->CALL gds.wcc.stream('WCC')
YIELD componentId,nodeId
WITH componentId AS cluster,gds.util.asNode(nodeId) AS client
WITH cluster, collect(client.id) AS clients
WITH *,size(clients) AS clusterSize
WHERE clusterSize&gt;1
UNWIND clients AS client
MATCH(c:Client)
WHERE c.id=client
SET c.firstPartyFraudGroup=cluster;<!--/code--></pre>
</div>
</div>
	</div>
  </div>
</slide>



<slide class="row-fluid">
  <div class="col-sm-12">
    <h3>Exercise 1, Task 8: Identifying and saving big clusters in a Cypher Parameter</h3>
    <br/>
    <div>
      <div class="listingblock">
<div class="content">
<pre mode="cypher"  class="highlight pre-scrollable programlisting cm-s-neo code runnable standalone-example ng-binding" data-lang="cypher" lang="cypher"><!--code class="cypher language-cypher"-->:param bigFirstPartyFraudGroups=&gt;apoc.cypher.runFirstColumnSingle('MATCH (c:Client) WHERE exists(c.firstPartyFraudGroup) WITH c.firstPartyFraudGroup AS firstPartyFraudGroupId,collect(c.id) AS group WITH *, size(group) AS groupSize WHERE groupSize &gt;= 3 RETURN collect(firstPartyFraudGroupId) AS bigFirstPartyFraudGroups',{});<!--/code--></pre>
</div>
</div>
	</div>
  </div>
</slide>



<slide class="row-fluid">
  <div class="col-sm-12">
    <h3>Exercise 1, Task 9: Big Clusters Visualization</h3>
    <br/>
    <div>
      <div class="listingblock">
<div class="content">
<pre mode="cypher"  class="highlight pre-scrollable programlisting cm-s-neo code runnable standalone-example ng-binding" data-lang="cypher" lang="cypher"><!--code class="cypher language-cypher"-->MATCH p=(c:Client)-[:HAS_SSN|HAS_EMAIL|HAS_PHONE]-&gt;()
WHERE c.firstPartyFraudGroup IN $bigFirstPartyFraudGroups
RETURN p;<!--/code--></pre>
</div>
</div>
	</div>
  </div>
</slide>



<slide class="row-fluid">
  <div class="col-sm-12">
    <h3>Exercise 2: Pairwise Similarity Calculation</h3>
    <br/>
    <div>
      <div class="paragraph">
<p>This exercise is compose of the following task:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Load Similarity Named Graph</p>
</li>
<li>
<p>Execute the Node Similarity procedure and stream the results</p>
</li>
<li>
<p>Mutate the in-memory graph to store these results in it</p>
</li>
<li>
<p>Write the results from the in-memory graph to the database</p>
</li>
<li>
<p>Visualize the results</p>
</li>
</ol>
</div>
	</div>
  </div>
</slide>



<slide class="row-fluid">
  <div class="col-sm-12">
    <h3>Exercise 2, Task 1: Loading the Similarity Graph to the Graph Catalog</h3>
    <br/>
    <div>
      <div class="listingblock">
<div class="content">
<pre mode="cypher"  class="highlight pre-scrollable programlisting cm-s-neo code runnable standalone-example ng-binding" data-lang="cypher" lang="cypher"><!--code class="cypher language-cypher"-->CALL gds.graph.create.cypher('Similarity',
'MATCH(c:Client)
    WHERE exists(c.firstPartyFraudGroup)
    RETURN id(c) AS id,labels(c) AS labels
UNION
MATCH(n)
    WHERE n:Email OR n:Phone OR n:SSN
    RETURN id(n) AS id,labels(n) AS labels',
'MATCH(c:Client)
-[:HAS_EMAIL|:HAS_PHONE|:HAS_SSN]-&gt;(ids)
WHERE exists(c.firstPartyFraudGroup)
RETURN id(c) AS source,id(ids) AS target')
YIELD graphName,nodeCount,relationshipCount,createMillis;<!--/code--></pre>
</div>
</div>
	</div>
  </div>
</slide>



<slide class="row-fluid">
  <div class="col-sm-12">
    <h3>Exercise 2, Task 2: Streaming the Similarity Results</h3>
    <br/>
    <div>
      <div class="listingblock">
<div class="content">
<pre mode="cypher"  class="highlight pre-scrollable programlisting cm-s-neo code runnable standalone-example ng-binding" data-lang="cypher" lang="cypher"><!--code class="cypher language-cypher"-->CALL gds.nodeSimilarity.stream('Similarity',{topK:15})
YIELD node1,node2,similarity
RETURN gds.util.asNode(node1).id AS client1,
    gds.util.asNode(node2).id AS client2,similarity
ORDER BY similarity;<!--/code--></pre>
</div>
</div>
	</div>
  </div>
</slide>



<slide class="row-fluid">
  <div class="col-sm-12">
    <h3>Exercise 2, Task 3: Saving the Similarity Results to the In-memory Graph</h3>
    <br/>
    <div>
      <div class="listingblock">
<div class="content">
<pre mode="cypher"  class="highlight pre-scrollable programlisting cm-s-neo code runnable standalone-example ng-binding" data-lang="cypher" lang="cypher"><!--code class="cypher language-cypher"-->CALL gds.nodeSimilarity.mutate('Similarity',{topK:15,
  mutateProperty:'jaccardScore', mutateRelationshipType:'SIMILAR_TO'});<!--/code--></pre>
</div>
</div>
	</div>
  </div>
</slide>



<slide class="row-fluid">
  <div class="col-sm-12">
    <h3>Exercise 2, Task 4: Writing the In-memory Graph Edges to the Database</h3>
    <br/>
    <div>
      <div class="listingblock">
<div class="content">
<pre mode="cypher"  class="highlight pre-scrollable programlisting cm-s-neo code runnable standalone-example ng-binding" data-lang="cypher" lang="cypher"><!--code class="cypher language-cypher"-->CALL gds.graph.writeRelationship('Similarity','SIMILAR_TO','jaccardScore');<!--/code--></pre>
</div>
</div>
	</div>
  </div>
</slide>



<slide class="row-fluid">
  <div class="col-sm-12">
    <h3>Exercise 2, Task 5: Similarity Results Visualization</h3>
    <br/>
    <div>
      <div class="listingblock">
<div class="content">
<pre mode="cypher"  class="highlight pre-scrollable programlisting cm-s-neo code runnable standalone-example ng-binding" data-lang="cypher" lang="cypher"><!--code class="cypher language-cypher"-->MATCH p=(c:Client)-[:SIMILAR_TO]-&gt;()
WHERE c.firstPartyFraudGroup IN $bigFirstPartyFraudGroups
RETURN p;<!--/code--></pre>
</div>
</div>
	</div>
  </div>
</slide>



<slide class="row-fluid">
  <div class="col-sm-12">
    <h3>Exercise 3: First-party Fraud Score</h3>
    <br/>
    <div>
      <div class="paragraph">
<p>This exercise is compose by the following task:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Explore the Degree Centrality Results</p>
</li>
<li>
<p>Store the results of Degree Centrality to the database</p>
</li>
<li>
<p>Set a threshold for first-party fraud identification</p>
</li>
<li>
<p>Labeling clients as first-party fraudsters</p>
</li>
</ol>
</div>
	</div>
  </div>
</slide>



<slide class="row-fluid">
  <div class="col-sm-12">
    <h3>Exercise 3, Task 1: Looking at the Degree Centrality Results</h3>
    <br/>
    <div>
      <div class="listingblock">
<div class="content">
<pre mode="cypher"  class="highlight pre-scrollable programlisting cm-s-neo code runnable standalone-example ng-binding" data-lang="cypher" lang="cypher"><!--code class="cypher language-cypher"-->CALL gds.alpha.degree.stream('Similarity',{nodeLabels:['Client'],relationshipTypes:['SIMILAR_TO'],relationshipWeightProperty:'jaccardScore'})
YIELD nodeId,score
RETURN gds.util.asNode(nodeId).id AS client,score
ORDER BY score DESC;<!--/code--></pre>
</div>
</div>
	</div>
  </div>
</slide>



<slide class="row-fluid">
  <div class="col-sm-12">
    <h3>Exercise 3, Task 2: Writing the Degree Centrality to the database</h3>
    <br/>
    <div>
      <div class="listingblock">
<div class="content">
<pre mode="cypher"  class="highlight pre-scrollable programlisting cm-s-neo code runnable standalone-example ng-binding" data-lang="cypher" lang="cypher"><!--code class="cypher language-cypher"-->CALL gds.alpha.degree.write('Similarity',{nodeLabels:['Client'],
    relationshipTypes:['SIMILAR_TO'],
    relationshipWeightProperty:'jaccardScore',
    writeProperty:'firstPartyFraudScore'});<!--/code--></pre>
</div>
</div>
	</div>
  </div>
</slide>



<slide class="row-fluid">
  <div class="col-sm-12">
    <h3>Exercise 3, Task 3: Setting a Threshold for the First-party Fraud Score</h3>
    <br/>
    <div>
      <div class="paragraph">
<p>Setting the threshold</p>
</div>
<div class="listingblock">
<div class="content">
<pre mode="cypher"  class="highlight pre-scrollable programlisting cm-s-neo code runnable standalone-example ng-binding" data-lang="cypher" lang="cypher"><!--code class="cypher language-cypher"-->:param firstPartyFraudThreshold=&gt;.80;<!--/code--></pre>
</div>
</div>
<div class="paragraph">
<p>Exploring the clients with first-party fraud score grater than the threshold</p>
</div>
<div class="listingblock">
<div class="content">
<pre mode="cypher"  class="highlight pre-scrollable programlisting cm-s-neo code runnable standalone-example ng-binding" data-lang="cypher" lang="cypher"><!--code class="cypher language-cypher"-->MATCH(c:Client)
WHERE exists(c.firstPartyFraudScore)
WITH percentileCont(c.firstPartyFraudScore,$firstPartyFraudThreshold)
    AS firstPartyFraudThreshold
MATCH(c:Client)
WHERE c.firstPartyFraudScore&gt;firstPartyFraudThreshold
RETURN c.name,c.firstPartyFraudScore
ORDER BY c.firstPartyFraudScore DESC;<!--/code--></pre>
</div>
</div>
	</div>
  </div>
</slide>



<slide class="row-fluid">
  <div class="col-sm-12">
    <h3>Exercise 3, Task 4: Identifying First-party Fraudsters</h3>
    <br/>
    <div>
      <div class="listingblock">
<div class="content">
<pre mode="cypher"  class="highlight pre-scrollable programlisting cm-s-neo code runnable standalone-example ng-binding" data-lang="cypher" lang="cypher"><!--code class="cypher language-cypher"-->MATCH(c:Client)
WHERE exists(c.firstPartyFraudScore)
WITH percentileCont(c.firstPartyFraudScore,$firstPartyFraudThreshold)
    AS firstPartyFraudThreshold
MATCH(c:Client)
WHERE c.firstPartyFraudScore&gt;firstPartyFraudThreshold
SET c:FirstPartyFraudster;<!--/code--></pre>
</div>
</div>
	</div>
  </div>
</slide>



<slide class="row-fluid">
  <div class="col-sm-12">
    <h3>Exercise 4: Removing all graphs in the Graph Catalog</h3>
    <br/>
    <div>
      <div class="listingblock">
<div class="content">
<pre mode="cypher"  class="highlight pre-scrollable programlisting cm-s-neo code runnable standalone-example ng-binding" data-lang="cypher" lang="cypher"><!--code class="cypher language-cypher"-->CALL gds.graph.list()
YIELD graphName AS namedGraph
WITH namedGraph
CALL gds.graph.drop(namedGraph)
YIELD graphName
RETURN graphName;<!--/code--></pre>
</div>
</div>
	</div>
  </div>
</slide>



<slide class="row-fluid">
  <div class="col-sm-12">
    <h3>End of Module 3</h3>
    <br/>
    <div>
      <table class="table tableblock frame-none grid-all" style="width: 100%;">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">In this module we were accomplished the following tasks:</p><p class="tableblock">1. Identified clusters of clients sharing PII</p><p class="tableblock">2. Conducted pairwise similarity calculations based on shared PII</p><p class="tableblock">3. Created a first-party fraud score</p><p class="tableblock">4. Identified first-party fraudsters</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="https://guides.neo4j.com/gds-paysim-demo/img/degreeDisplay.png" alt="Schema" width="300"></span></p></td>
</tr>
</tbody>
</table>
	</div>
  </div>
</slide>



<slide class="row-fluid">
  <div class="col-sm-12">
    <h3>Module 4: Second-party Fraud</h3>
    <br/>
    <div>
      <div class="paragraph">
<p>This module consists of the following exercises:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Identify transactions between first-party fraudsters and other clients</p>
</li>
<li>
<p>Explore the type of transactions between these two groups</p>
</li>
<li>
<p>Create TRANSFER_TO relationships between first-party fraudsters and clients</p>
</li>
<li>
<p>Visualize the TRANSFER_TO relationships</p>
</li>
<li>
<p>Identify Second-party Fraud</p>
</li>
<li>
<p>Remove all Named Graph loaded in this module</p>
</li>
</ol>
</div>
	</div>
  </div>
</slide>



<slide class="row-fluid">
  <div class="col-sm-12">
    <h3>Exercise 1: Identifying Transactions Between First-party Fraudsters and Client</h3>
    <br/>
    <div>
      <div class="listingblock">
<div class="content">
<pre mode="cypher"  class="highlight pre-scrollable programlisting cm-s-neo code runnable standalone-example ng-binding" data-lang="cypher" lang="cypher"><!--code class="cypher language-cypher"-->MATCH p=(:Client:FirstPartyFraudster)-[]-(:Transaction)-[]-(c:Client)
WHERE NOT c:FirstPartyFraudster
RETURN p;<!--/code--></pre>
</div>
</div>
	</div>
  </div>
</slide>



<slide class="row-fluid">
  <div class="col-sm-12">
    <h3>Exercise 2: What are the types of Transactions Between First-party Fraudsters and Clients?</h3>
    <br/>
    <div>
      <div class="listingblock">
<div class="content">
<pre mode="cypher"  class="highlight pre-scrollable programlisting cm-s-neo code runnable standalone-example ng-binding" data-lang="cypher" lang="cypher"><!--code class="cypher language-cypher"-->MATCH (:Client:FirstPartyFraudster)-[]-(txn:Transaction)-[]-(c:Client)
WHERE NOT c:FirstPartyFraudster
UNWIND labels(txn) AS transactionType
RETURN transactionType, count(*) AS freq;<!--/code--></pre>
</div>
</div>
	</div>
  </div>
</slide>



<slide class="row-fluid">
  <div class="col-sm-12">
    <h3>Exercise 3: Creating TRANSFER_TO Relationships Between First-party Fraudsters and Clients</h3>
    <br/>
    <div>
      <div class="paragraph">
<p>From first-party fraudsters to client</p>
</div>
<div class="listingblock">
<div class="content">
<pre mode="cypher"  class="highlight pre-scrollable programlisting cm-s-neo code runnable standalone-example ng-binding" data-lang="cypher" lang="cypher"><!--code class="cypher language-cypher"-->MATCH (c1:Client:FirstPartyFraudster)-[]-&gt;(t:Transaction)-[]-&gt;(c2:Client)
WHERE NOT c2:FirstPartyFraudster
WITH c1,c2,sum(t.amount) AS totalAmount
SET c2:SecondPartyFraudSuspect
MERGE (c1)-[t:TRANSFER_TO]-&gt;(c2)
	ON CREATE SET t.amount=totalAmount;<!--/code--></pre>
</div>
</div>
<div class="paragraph">
<p>From clients to first-party fraudsters</p>
</div>
<div class="listingblock">
<div class="content">
<pre mode="cypher"  class="highlight pre-scrollable programlisting cm-s-neo code runnable standalone-example ng-binding" data-lang="cypher" lang="cypher"><!--code class="cypher language-cypher"-->MATCH (c1:Client:FirstPartyFraudster)&lt;-[]-(t:Transaction)&lt;-[]-(c2:Client)
WITH c1,c2,sum(t.amount) AS totalAmount
MERGE (c1)&lt;-[t:TRANSFER_TO]-(c2)
	ON CREATE SET t.amount=totalAmount;<!--/code--></pre>
</div>
</div>
	</div>
  </div>
</slide>



<slide class="row-fluid">
  <div class="col-sm-12">
    <h3>Exercise 4: Visualizing the TRANSFER_TO Relationships</h3>
    <br/>
    <div>
      <div class="listingblock">
<div class="content">
<pre mode="cypher"  class="highlight pre-scrollable programlisting cm-s-neo code runnable standalone-example ng-binding" data-lang="cypher" lang="cypher"><!--code class="cypher language-cypher"-->MATCH p=(:Client:FirstPartyFraudster)-[:TRANSFER_TO]-(c:Client)
WHERE NOT c:FirstPartyFraudster
RETURN p;<!--/code--></pre>
</div>
</div>
	</div>
  </div>
</slide>



<slide class="row-fluid">
  <div class="col-sm-12">
    <h3>Exercise 5: Identifying Second-party Fraud</h3>
    <br/>
    <div>
      <div class="paragraph">
<p>This exercise is compose of the following tasks:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Using Native Projection to load a graph to the Graph Catalog containing the TRANSFER_TO relationships</p>
</li>
<li>
<p>Explore WCC results to identify potential Second-party Fraud groups</p>
</li>
<li>
<p>Store the identified potential Second-party Fraud groups</p>
</li>
<li>
<p>Explore Page Rank results for Second-party Fraud Identification</p>
</li>
<li>
<p>Store the Page Rank results to the database</p>
</li>
<li>
<p>Explore Louvain results for Cluster identification within the Second Party-fraud Network</p>
</li>
<li>
<p>Store the Louvain results to the database</p>
</li>
<li>
<p>Visualize the Second-party Fraud Network</p>
</li>
</ol>
</div>
	</div>
  </div>
</slide>



<slide class="row-fluid">
  <div class="col-sm-12">
    <h3>Exercise 5, Task 1: Loading Second-party Fraud Network In-memory Graph</h3>
    <br/>
    <div>
      <div class="listingblock">
<div class="content">
<pre mode="cypher"  class="highlight pre-scrollable programlisting cm-s-neo code runnable standalone-example ng-binding" data-lang="cypher" lang="cypher"><!--code class="cypher language-cypher"-->CALL gds.graph.create('SecondPartyFraudNetwork','Client','TRANSFER_TO',{relationshipProperties:'amount'});<!--/code--></pre>
</div>
</div>
	</div>
  </div>
</slide>



<slide class="row-fluid">
  <div class="col-sm-12">
    <h3>Exercise 5, Task 2: Identifying Potential Second-party Fraud Clusters</h3>
    <br/>
    <div>
      <div class="listingblock">
<div class="content">
<pre mode="cypher"  class="highlight pre-scrollable programlisting cm-s-neo code runnable standalone-example ng-binding" data-lang="cypher" lang="cypher"><!--code class="cypher language-cypher"-->CALL gds.wcc.stream('SecondPartyFraudNetwork')
YIELD nodeId,componentId
WITH gds.util.asNode(nodeId) AS client,componentId AS clusterId
WITH clusterId,collect(client.id) AS cluster
WITH clusterId,size(cluster) AS clusterSize,cluster
WHERE clusterSize&gt;1
RETURN clusterId,clusterSize
ORDER BY clusterSize DESC;<!--/code--></pre>
</div>
</div>
	</div>
  </div>
</slide>



<slide class="row-fluid">
  <div class="col-sm-12">
    <h3>Exercise 5, Task 3: Writing the Potential Second-party Fraud Clusters to the Database</h3>
    <br/>
    <div>
      <div class="listingblock">
<div class="content">
<pre mode="cypher"  class="highlight pre-scrollable programlisting cm-s-neo code runnable standalone-example ng-binding" data-lang="cypher" lang="cypher"><!--code class="cypher language-cypher"-->CALL gds.wcc.stream('SecondPartyFraudNetwork')
YIELD nodeId,componentId
WITH gds.util.asNode(nodeId) AS client,componentId AS clusterId
WITH clusterId,collect(client.id) AS cluster
WITH clusterId,size(cluster) AS clusterSize,cluster
WHERE clusterSize&gt;1
UNWIND cluster AS client
MATCH(c:Client {id:client})
SET c.secondPartyFraudGroup=clusterId;<!--/code--></pre>
</div>
</div>
	</div>
  </div>
</slide>



<slide class="row-fluid">
  <div class="col-sm-12">
    <h3>Exercise 5, Task 4: Identifying Second-party Fraudsters</h3>
    <br/>
    <div>
      <div class="listingblock">
<div class="content">
<pre mode="cypher"  class="highlight pre-scrollable programlisting cm-s-neo code runnable standalone-example ng-binding" data-lang="cypher" lang="cypher"><!--code class="cypher language-cypher"-->CALL gds.pageRank.stream('SecondPartyFraudNetwork',{relationshipWeightProperty:'amount'})
YIELD nodeId,score
WITH gds.util.asNode(nodeId) AS client,score AS pageRankScore
WHERE exists(client.secondPartyFraudGroup)
RETURN client.secondPartyFraudGroup,client.name,labels(client),pageRankScore
ORDER BY client.secondPartyFraudGroup,pageRankScore DESC;<!--/code--></pre>
</div>
</div>
	</div>
  </div>
</slide>



<slide class="row-fluid">
  <div class="col-sm-12">
    <h3>Exercise 5, Task 5: Writing the Second-party Fraudsters Identification Results to the Database</h3>
    <br/>
    <div>
      <div class="listingblock">
<div class="content">
<pre mode="cypher"  class="highlight pre-scrollable programlisting cm-s-neo code runnable standalone-example ng-binding" data-lang="cypher" lang="cypher"><!--code class="cypher language-cypher"-->CALL gds.pageRank.stream('SecondPartyFraudNetwork',{relationshipWeightProperty:'amount'})
YIELD nodeId,score
WITH gds.util.asNode(nodeId) AS client,score AS pageRankScore
WHERE exists(client.secondPartyFraudGroup)
	AND pageRankScore &gt;1 AND NOT client:FirstPartyFraudster
MATCH(c:Client {id:client.id})
SET c:SecondPartyFraud
SET c.secondPartyFraudScore=pageRankScore;<!--/code--></pre>
</div>
</div>
	</div>
  </div>
</slide>



<slide class="row-fluid">
  <div class="col-sm-12">
    <h3>Exercise 5, Task 6: Visualizing the Second-party Fraud Network</h3>
    <br/>
    <div>
      <div class="listingblock">
<div class="content">
<pre mode="cypher"  class="highlight pre-scrollable programlisting cm-s-neo code runnable standalone-example ng-binding" data-lang="cypher" lang="cypher"><!--code class="cypher language-cypher"-->MATCH p=(:Client:FirstPartyFraudster)-[:TRANSFER_TO]-(c:Client)
WHERE NOT c:FirstPartyFraudster
RETURN p;<!--/code--></pre>
</div>
</div>
	</div>
  </div>
</slide>



<slide class="row-fluid">
  <div class="col-sm-12">
    <h3>Exercise 5, Task 7: Using Louvain to Identify Clusters in the Second-party Fraud Network</h3>
    <br/>
    <div>
      <div class="listingblock">
<div class="content">
<pre mode="cypher"  class="highlight pre-scrollable programlisting cm-s-neo code runnable standalone-example ng-binding" data-lang="cypher" lang="cypher"><!--code class="cypher language-cypher"-->CALL gds.louvain.stream('SecondPartyFraudNetwork',{relationshipWeightProperty:'amount'})
YIELD nodeId,communityId
WITH gds.util.asNode(nodeId) AS client,communityId AS clusterId
WITH clusterId,collect(client.id) AS cluster,10^3 AS factor,
	avg(client.firstPartyFraudScore) AS meanFirstPartyFraudScore,
    avg(client.secondPartyFraudScore) AS meanSecondPartyFraudScore
WITH clusterId,size(cluster) AS clusterSize,cluster,
	round(meanFirstPartyFraudScore * factor)/factor AS meanFirstPartyFraudScore,
    CASE
    	WHEN meanSecondPartyFraudScore IS NULL THEN 0
        ELSE round(meanSecondPartyFraudScore * factor)/factor
    END AS meanSecondPartyFraudScore
WHERE clusterSize&gt;1
RETURN clusterId,clusterSize,cluster,meanFirstPartyFraudScore,meanSecondPartyFraudScore
ORDER BY meanSecondPartyFraudScore DESC,meanFirstPartyFraudScore DESC,clusterSize DESC;<!--/code--></pre>
</div>
</div>
	</div>
  </div>
</slide>



<slide class="row-fluid">
  <div class="col-sm-12">
    <h3>Exercise 5, Task 8: Storing Second-party Fraud Network Louvain Clusters to the Database</h3>
    <br/>
    <div>
      <div class="listingblock">
<div class="content">
<pre mode="cypher"  class="highlight pre-scrollable programlisting cm-s-neo code runnable standalone-example ng-binding" data-lang="cypher" lang="cypher"><!--code class="cypher language-cypher"-->CALL gds.louvain.stream('SecondPartyFraudNetwork',{relationshipWeightProperty:'amount'})
YIELD nodeId,communityId
WITH gds.util.asNode(nodeId) AS client,communityId AS clusterId
WITH clusterId,collect(client) AS cluster
WITH clusterId,size(cluster) AS clusterSize,cluster
WHERE clusterSize&gt;1
UNWIND cluster AS client
MATCH(c:Client)
WHERE c.id=client.id
SET c.secondPartyFraudInnerGroup=clusterId;<!--/code--></pre>
</div>
</div>
	</div>
  </div>
</slide>



<slide class="row-fluid">
  <div class="col-sm-12">
    <h3>Exercise 6: Removing all graphs in the Graph Catalog</h3>
    <br/>
    <div>
      <div class="listingblock">
<div class="content">
<pre mode="cypher"  class="highlight pre-scrollable programlisting cm-s-neo code runnable standalone-example ng-binding" data-lang="cypher" lang="cypher"><!--code class="cypher language-cypher"-->CALL gds.graph.list()
YIELD graphName AS namedGraph
WITH namedGraph
CALL gds.graph.drop(namedGraph)
YIELD graphName
RETURN graphName;<!--/code--></pre>
</div>
</div>
	</div>
  </div>
</slide>



<slide class="row-fluid">
  <div class="col-sm-12">
    <h3>End of Module 4</h3>
    <br/>
    <div>
      <div class="paragraph">
<p>In this module we accomplish the following task:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Identified cluster of clients and first-party fraudsters transferring money between them</p>
</li>
<li>
<p>Calculated a second-party fraud score and identified second-party fraudsters based on it</p>
</li>
<li>
<p>Identified inner clusters in the Second-party Fraud Network</p>
</li>
</ol>
</div>
	</div>
  </div>
</slide>



<slide class="row-fluid">
  <div class="col-sm-12">
    <h3>End</h3>
    <br/>
    <div>
      <div class="imageblock" style="text-align: center;">
<div class="content">
<img src="https://guides.neo4j.com/gds-paysim-demo/img/secondPartyFrameNetwork.png" alt="Schema" width="600">
</div>
</div>
	</div>
  </div>
</slide>
  </carousel>
</article>